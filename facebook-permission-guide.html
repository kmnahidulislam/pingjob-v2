<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Facebook Permissions Setup Guide</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            max-width: 800px; 
            margin: 0 auto; 
            padding: 20px; 
            line-height: 1.6; 
        }
        .step { 
            background: #f5f5f5; 
            padding: 15px; 
            margin: 10px 0; 
            border-left: 4px solid #4267B2; 
        }
        .permission { 
            background: #e8f5e8; 
            padding: 5px 10px; 
            margin: 5px 0; 
            border-radius: 3px; 
        }
        .error { 
            background: #ffe6e6; 
            padding: 10px; 
            border-left: 4px solid #ff4444; 
            margin: 10px 0; 
        }
        .success { 
            background: #e6ffe6; 
            padding: 10px; 
            border-left: 4px solid #44ff44; 
            margin: 10px 0; 
        }
        code { 
            background: #f0f0f0; 
            padding: 2px 4px; 
            border-radius: 3px; 
        }
        .url { 
            word-break: break-all; 
            background: #f0f0f0; 
            padding: 10px; 
            border-radius: 5px; 
            font-family: monospace; 
        }
    </style>
</head>
<body>
    <h1>Facebook Posting Permissions Setup</h1>
    
    <div class="error">
        <h3>Current Issue:</h3>
        <p>Your token is missing admin permissions for your Facebook page. The error indicates you need both <code>pages_read_engagement</code> and <code>pages_manage_posts</code> permissions AND admin access to the page.</p>
    </div>

    <h2>Step-by-Step Solution:</h2>

    <div class="step">
        <h3>Step 1: Verify Page Admin Status</h3>
        <p>First, make sure you are an admin of your Facebook page:</p>
        <ol>
            <li>Go to your Facebook page: <strong>https://facebook.com/786417694545751</strong></li>
            <li>Click "Settings" in the left menu</li>
            <li>Click "Page roles" or "People and other pages"</li>
            <li>Verify you are listed as "Admin" (not just Editor or Moderator)</li>
            <li>If not admin, you need to get admin access from the current page owner</li>
        </ol>
    </div>

    <div class="step">
        <h3>Step 2: Get User Access Token with Proper Permissions</h3>
        <p>Go to Facebook Graph API Explorer and get a new token:</p>
        <ol>
            <li>Open: <strong>https://developers.facebook.com/tools/explorer/</strong></li>
            <li>Select your app: <strong>PingJob Platform</strong> (App ID: 1377200590045125)</li>
            <li>Click <strong>"Get Token"</strong> → <strong>"Get User Access Token"</strong></li>
            <li>Add these permissions (click "Add a Permission" for each):</li>
        </ol>
        
        <div class="permission">✓ pages_show_list</div>
        <div class="permission">✓ pages_manage_posts</div>
        <div class="permission">✓ pages_read_engagement</div>
        <div class="permission">✓ publish_to_groups (optional)</div>
        
        <ol start="5">
            <li>Click <strong>"Generate Access Token"</strong></li>
            <li>Authorize all permissions when Facebook asks</li>
            <li>Copy the generated token</li>
        </ol>
    </div>

    <div class="step">
        <h3>Step 3: Get Page Access Token</h3>
        <p>Use the user token to get a page token:</p>
        <ol>
            <li>In the same Graph API Explorer, paste this query: <code>me/accounts</code></li>
            <li>Click <strong>"Submit"</strong></li>
            <li>Look for your page in the response (name should match your page)</li>
            <li>Copy the <code>access_token</code> field from your page object</li>
            <li>This page access token will have admin permissions</li>
        </ol>
    </div>

    <div class="step">
        <h3>Step 4: Test the Page Token</h3>
        <p>Test posting with your page token:</p>
        <ol>
            <li>In Graph API Explorer, change the endpoint to: <code>786417694545751/feed</code></li>
            <li>Change method from GET to POST</li>
            <li>Paste your page access token in the token field</li>
            <li>Add parameter: <code>message</code> = <code>Test post from PingJob Platform</code></li>
            <li>Click Submit - you should see a successful response with post ID</li>
        </ol>
    </div>

    <h2>Alternative: Facebook App Review Process</h2>
    
    <div class="step">
        <p>If the above doesn't work, your app might need Facebook's approval for posting permissions:</p>
        <ol>
            <li>Go to your Facebook App dashboard</li>
            <li>Navigate to "App Review" → "Permissions and Features"</li>
            <li>Request these permissions:
                <ul>
                    <li>pages_manage_posts</li>
                    <li>pages_read_engagement</li>
                </ul>
            </li>
            <li>Provide use case documentation explaining you need to post job listings</li>
            <li>Submit for review (may take 2-7 days)</li>
        </ol>
    </div>

    <h2>Quick Debug Commands</h2>
    
    <div class="step">
        <p>You can test your tokens using these curl commands:</p>
        
        <h4>Test User Token Permissions:</h4>
        <div class="url">curl "https://graph.facebook.com/me/permissions?access_token=YOUR_USER_TOKEN"</div>
        
        <h4>Get Page Access Token:</h4>
        <div class="url">curl "https://graph.facebook.com/me/accounts?access_token=YOUR_USER_TOKEN"</div>
        
        <h4>Test Page Posting:</h4>
        <div class="url">curl -X POST "https://graph.facebook.com/786417694545751/feed" -d "message=Test post" -d "access_token=YOUR_PAGE_TOKEN"</div>
    </div>

    <div class="success">
        <h3>Expected Result:</h3>
        <p>After following these steps, you should get a page access token that allows posting to your Facebook page. Provide me with this working page access token and job editing will automatically post to Facebook.</p>
    </div>

</body>
</html>